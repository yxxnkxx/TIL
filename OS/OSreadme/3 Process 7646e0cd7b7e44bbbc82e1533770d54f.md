# 3. Process

## í”„ë¡œì„¸ìŠ¤ì˜ ê°œë…

**Process is a _program in execution_**

ğŸŸ¡ í”„ë¡œì„¸ìŠ¤ì˜ ë¬¸ë§¥(context)

CPU ìˆ˜í–‰ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” í•˜ë“œì›¨ì–´ ë¬¸ë§¥

- Program Counter
- ê°ì¢… register

í”„ë¡œì„¸ìŠ¤ì˜ ì£¼ì†Œ ê³µê°„

- code, data, stack

í”„ë¡œì„¸ìŠ¤ ê´€ë ¨ ì»¤ë„ ìë£Œ êµ¬ì¡°

- PCB (Process Control Block)
- Kernel stack

![Untitled](3%20Process%207646e0cd7b7e44bbbc82e1533770d54f/Untitled.png)

## í”„ë¡œì„¸ìŠ¤ì˜ ìƒíƒœ

ğŸŸ¡ í”„ë¡œì„¸ìŠ¤ëŠ” ìƒíƒœ(state)ê°€ ë³€ê²½ë˜ë©° ìˆ˜í–‰ëœë‹¤

- **Running**
  - CPUë¥¼ ì¡ê³  instructionì„ ìˆ˜í–‰ì¤‘ì¸ ìƒíƒœ
- **Ready**
  - CPUë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ìƒíƒœ(ë©”ëª¨ë¦¬ ë“± ë‹¤ë¥¸ ì¡°ê±´ì„ ëª¨ë‘ ë§Œì¡±í•˜ê³ )
- **Blocked(wait, sleep)**
  - CPUë¥¼ ì¤˜ë„ ë‹¹ì¥ instructionì„ ìˆ˜í–‰í•  ìˆ˜ ì—†ëŠ” ìƒíƒœ
  - Process ìì‹ ì´ ìš”ì²­í•œ event(ì˜ˆ:I/O)ê°€ ì¦‰ì‹œ ë§Œì¡±ë˜ì§€ ì•Šì•„ ì´ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ìƒíƒœ
  - ì˜ˆ) ë””ìŠ¤í¬ì—ì„œ fileì„ ì½ì–´ì™€ì•¼ í•˜ëŠ” ê²½ìš°
- **Suspended (stopped)**
  - ì™¸ë¶€ì ì¸ ì´ìœ ë¡œ í”„ë¡œì„¸ìŠ¤ì˜ ìˆ˜í–‰ì´ ì •ì§€ëœ ìƒíƒœ (medium-term scheduler)
  - í”„ë¡œì„¸ìŠ¤ëŠ” í†µì§¸ë¡œ ë””ìŠ¤í¬ì— swap out ëœë‹¤
  - ì˜ˆ) ì‚¬ìš©ìê°€ í”„ë¡œê·¸ë¨ì„ ì¼ì‹œ ì •ì§€ì‹œí‚¨ ê²½ìš° (break key) ì‹œìŠ¤í…œì´ ì—¬ëŸ¬ ì´ìœ ë¡œ í”„ë¡œì„¸ìŠ¤ë¥¼ ì ì‹œ ì¤‘ë‹¨ì‹œí‚´ (ë©”ëª¨ë¦¬ì— ë„ˆë¬´ ë§ì€ í”„ë¡œì„¸ìŠ¤ê°€ ì˜¬ë¼ì™€ ìˆì„ ë•Œ)
    - blocked: ìì‹ ì´ ìš”ì²­í•œ eventê°€ ë§Œì¡±ë˜ë©´ ready
    - suspended: ì™¸ë¶€ì—ì„œ resumeí•´ì£¼ì–´ì•¼ Active

New: í”„ë¡œì„¸ìŠ¤ê°€ ìƒì„±ì¤‘ì¸ ìƒíƒœ

Terminated: ìˆ˜í–‰(execution)ì´ ëë‚œ ìƒíƒœ

### í”„ë¡œì„¸ìŠ¤ ìƒíƒœë„

![Untitled](3%20Process%207646e0cd7b7e44bbbc82e1533770d54f/Untitled%201.png)

![Untitled](3%20Process%207646e0cd7b7e44bbbc82e1533770d54f/Untitled%202.png)

## Process Control Block (PCB)

ìš´ì˜ì²´ì œê°€ ê° í”„ë¡œì„¸ìŠ¤ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•´ í”„ë¡œì„¸ìŠ¤ë‹¹ ìœ ì§€í•˜ëŠ” ì •ë³´

ğŸŸ¡ êµ¬ì„±ìš”ì†Œ (êµ¬ì¡°ì²´ë¡œ ìœ ì§€)

- OSê°€ ê´€ë¦¬ìƒ ì‚¬ìš©í•˜ëŠ” ì •ë³´
  - Process state, Process ID
  - scheduling information, priority
- CPU ìˆ˜í–‰ ê´€ë ¨ í•˜ë“œì›¨ì–´ ê°’
  - Program counter, registers
- ë©”ëª¨ë¦¬ ê´€ë ¨
  - Code, data, stackì˜ ìœ„ì¹˜ ì •ë³´
- íŒŒì¼ ê´€ë ¨
  - Open file descriptors

![Untitled](3%20Process%207646e0cd7b7e44bbbc82e1533770d54f/Untitled%203.png)

## ë¬¸ë§¥ êµí™˜ (Context Switch)

**CPUë¥¼ í•œ í”„ë¡œì„¸ìŠ¤ì—ì„œ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ë¡œ ë„˜ê²¨ì£¼ëŠ” ê³¼ì •**

CPUê°€ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì—ê²Œ ë„˜ì–´ê°ˆ ë•Œ ìš´ì˜ì²´ì œëŠ” ë‹¤ìŒì„ ìˆ˜í–‰

- CPUë¥¼ ë‚´ì–´ì£¼ëŠ” í”„ë¡œì„¸ìŠ¤ì˜ ìƒíƒœë¥¼ ê·¸ í”„ë¡œì„¸ìŠ¤ì˜ PCBì— ì €ì¥
- CPUë¥¼ ìƒˆë¡­ê²Œ ì–»ëŠ” í”„ë¡œì„¸ìŠ¤ì˜ ìƒíƒœë¥¼ PCBì—ì„œ ì½ì–´ì˜´

![Untitled](3%20Process%207646e0cd7b7e44bbbc82e1533770d54f/Untitled%204.png)

â­ System callì´ë‚˜ Interrupt ë°œìƒ ì‹œ ë°˜ë“œì‹œ context switchê°€ ì¼ì–´ë‚˜ëŠ” ê±´ ì•„ë‹˜

![Untitled](3%20Process%207646e0cd7b7e44bbbc82e1533770d54f/Untitled%205.png)

ìš´ì˜ì²´ì œì— CPUë¥¼ ë„˜ê²¨ì£¼ê³ , ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ë¡œ ë„˜ì–´ê°„ë‹¤ë©´ context switch O

ë‹¤ì‹œ í•´ë‹¹ processë¡œ ëŒì•„ì˜¤ë©´ context switch X

(1)ì˜ ê²½ìš°ë„ CPU ìˆ˜í–‰ ì •ë³´ ë“± contextì˜ ì¼ë¶€ë¥¼ PCBì— saveí•´ì•¼ í•˜ì§€ë§Œ, ë¬¸ë§¥ êµí™˜ì„ í•˜ëŠ” (2)ì˜ ê²½ìš° ê·¸ ë¶€ë‹´ì´ í›¨ì”¬ í¼ (ex. cache memory flush)

## í”„ë¡œì„¸ìŠ¤ë¥¼ ìŠ¤ì¼€ì¤„ë§í•˜ê¸° ìœ„í•œ í

- Job queue
  - í˜„ì¬ ì‹œìŠ¤í…œ ë‚´ì— ìˆëŠ” ëª¨ë“  í”„ë¡œì„¸ìŠ¤ì˜ ì§‘í•©
  - Ready queue, Device queue í¬í•¨
- Ready queue
  - í˜„ì¬ ë©”ëª¨ë¦¬ ë‚´ì— ìˆìœ¼ë©´ì„œ CPUë¥¼ ì¡ì•„ì„œ ì‹¤í–‰ë˜ê¸°ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” í”„ë¡œì„¸ìŠ¤ì˜ ì§‘í•©
- Device queues
  - I/O deviceì˜ ì²˜ë¦¬ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” í”„ë¡œì„¸ìŠ¤ì˜ ì§‘í•©

í”„ë¡œì„¸ìŠ¤ë“¤ì€ ê° íë“¤ì„ ì˜¤ê°€ë©° ìˆ˜í–‰ëœë‹¤

![Untitled](3%20Process%207646e0cd7b7e44bbbc82e1533770d54f/Untitled%206.png)

í”„ë¡œì„¸ìŠ¤ ìŠ¤ì¼€ì¤„ë§ íì˜ ëª¨ìŠµ

![Untitled](3%20Process%207646e0cd7b7e44bbbc82e1533770d54f/Untitled%207.png)

## ìŠ¤ì¼€ì¤„ëŸ¬ Scheduler

- **Long-term scheduler** (ì¥ê¸° ìŠ¤ì¼€ì¤„ëŸ¬ or job scheduler)
  - ì‹œì‘ í”„ë¡œì„¸ìŠ¤ ì¤‘ ì–´ë–¤ ê²ƒë“¤ì„ ready queueë¡œ ë³´ë‚¼ì§€ ê²°ì •
  - í”„ë¡œì„¸ìŠ¤ì— memory(ë° ê°ì¢… ìì›)ì„ ì£¼ëŠ” ë¬¸ì œ
  - degree of Multiprogrammingì„ ì œì–´ (ë©”ëª¨ë¦¬ì— ì˜¬ë¼ê°€ ìˆëŠ” í”„ë¡œê·¸ë¨ì˜ ìˆ˜)
  - time sharing systemì—ëŠ” ë³´í†µ ì¥ê¸° ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ì—†ìŒ (ë¬´ì¡°ê±´ ready)
- **Short-term scheduler** (ë‹¨ê¸° ìŠ¤ì¼€ì¤„ëŸ¬ or CPU scheduler)
  - ì–´ë–¤ í”„ë¡œì„¸ìŠ¤ë¥¼ ë‹¤ìŒë²ˆì— runningì‹œí‚¬ì§€ ê²°ì •
  - í”„ë¡œì„¸ìŠ¤ì— CPUë¥¼ ì£¼ëŠ” ë¬¸ì œ
  - ì¶©ë¶„íˆ ë¹¨ë¼ì•¼ í•¨ (millisecond ë‹¨ìœ„)
- **Medium-Term Scheduler** (ì¤‘ê¸° ìŠ¤ì¼€ì¤„ëŸ¬ or Swapper)
  - ì—¬ìœ  ê³µê°„ ë§ˆë ¨ì„ ìœ„í•´ í”„ë¡œì„¸ìŠ¤ë¥¼ í†µì§¸ë¡œ ë©”ëª¨ë¦¬ì—ì„œ ë””ìŠ¤í¬ë¡œ ì«“ì•„ëƒ„
  - í”„ë¡œì„¸ìŠ¤ì—ê²Œì„œ memoryë¥¼ ëºëŠ” ë¬¸ì œ
  - degree of Multiprogrammingì„ ì œì–´

í”„ë¡œì„¸ìŠ¤ ìƒíƒœ

![Untitled](3%20Process%207646e0cd7b7e44bbbc82e1533770d54f/Untitled%208.png)

ìš´ì˜ì²´ì œì—ì„œ ì‹¤í–‰ë˜ë”ë¼ë„ ìš´ì˜ì²´ì œê°€ running (X), ê·¸ í”„ë¡œì„¸ìŠ¤ê°€ ìš´ì˜ì²´ì œì—ì„œ running (O)

## Thread

![Untitled](3%20Process%207646e0cd7b7e44bbbc82e1533770d54f/Untitled%209.png)

í”„ë¡œì„¸ìŠ¤ í•˜ë‚˜ì— CPU ìˆ˜í–‰ë‹¨ìœ„ë¥¼ ì—¬ëŸ¬ ê°œ ë‘ê³  ìˆëŠ” ê²ƒ

**â€œA thread (or lightweight process) is a basic unit of CPU utilizationâ€**

ğŸŸ¡ Threadì˜ êµ¬ì„±

- program counter
- register set
- stack space

ğŸŸ¡ Threadê°€ ë™ë£Œ threadì™€ ê³µìœ í•˜ëŠ” ë¶€ë¶„ (=task)

- code section
- data section
- OS resources

ì „í†µì ì¸ ê°œë…ì˜ heavyweight processëŠ” í•˜ë‚˜ì˜ threadë¥¼ ê°€ì§€ê³  ìˆëŠ” taskë¡œ ë³¼ ìˆ˜ ìˆë‹¤

- ë‹¤ì¤‘ ìŠ¤ë ˆë“œë¡œ êµ¬ì„±ëœ íƒœìŠ¤í¬ êµ¬ì¡°ì—ì„œëŠ” í•˜ë‚˜ì˜ ì„œë²„ ìŠ¤ë ˆë“œê°€ blocked (waiting) ìƒíƒœì¸ ë™ì•ˆì—ë„ ë™ì¼í•œ íƒœìŠ¤í¬ ë‚´ì˜ ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ ì‹¤í–‰ (running)ë˜ì–´ ë¹ ë¥¸ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤
- ë™ì¼í•œ ì¼ì„ ìˆ˜í–‰í•˜ëŠ” ë‹¤ì¤‘ ìŠ¤ë ˆë“œê°€ í˜‘ë ¥í•˜ì—¬ ë†’ì€ ì²˜ë¦¬ìœ¨(throughput)ê³¼ ì„±ëŠ¥ í–¥ìƒì„ ì–»ì„ ìˆ˜ ìˆë‹¤
- ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ë©´ ë³‘ë ¬ì„±ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤ (CPUê°€ ì—¬ëŸ¬ê°œì¼ ë•Œ)

![Untitled](3%20Process%207646e0cd7b7e44bbbc82e1533770d54f/Untitled%2010.png)

### ìŠ¤ë ˆë“œì˜ ì¥ì 

- Responsiveness(ì‘ë‹µì„±)
  - multi-threaded Web - if one thread is blokced (eg network), another thread continues (eg display
- Resource Sharing
  - n threads can share binary code, data, resource of the process
- Economy
  - creating & CPU switching thread (rather than a process)
  - í”„ë¡œì„¸ìŠ¤ì— ë¹„í•´ ìƒì„±, switch ë¹„ìš©ì´ ì ê²Œ ë“ ë‹¤ (íš¨ìœ¨ì )
  - Solarisì˜ ê²½ìš° ìœ„ ë‘ ê°€ì§€ê°€ overheadê°€ ê°ê° 30ë°°, 5ë°°
- Utilization of MP Architectures
  - each thread may be running in parallel on a different processor

### ìŠ¤ë ˆë“œì˜ êµ¬í˜„

- Some are supported by **kernel**
  - **kernel threads**
  - Window 95/98/NT
  - Solaris
  - Digital UNIX, Mach
  - ìŠ¤ë ˆë“œê°€ ì—¬ëŸ¬ ê°œ ìˆë‹¤ëŠ” ì‚¬ì‹¤ì„ ìš´ì˜ì²´ì œê°€ ì•Œê³  ìˆìŒ
  - ì»¤ë„ì´ CPU ìŠ¤ì¼€ì¤„ë§í•˜ë“¯ì´ switching
- Others are supported by **library**
  - **User threads**
  - POSIX Pthreads
  - Mach C-threads
  - Solaris threads
- Some are real-time threads
